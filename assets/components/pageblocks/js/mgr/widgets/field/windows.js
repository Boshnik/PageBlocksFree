PageBlocks.window.CreateField=function(e){(e=e||{}).aliaswasempty=!0,e.id||(e.id="pb-field-window-create"),Ext.applyIf(e,{title:_("pb_row_create"),action:"mgr/field/create"}),PageBlocks.window.CreateField.superclass.constructor.call(this,e)},Ext.extend(PageBlocks.window.CreateField,PageBlocks.window.Default,{getFields:function(i){i.record&&(i.model_type=i.record.model_type,i.model_id=i.record.model_id);let e=[{xtype:"hidden",name:"id",id:i.id+"-id"},{xtype:"hidden",name:"model_type",id:i.id+"-model_type"},{xtype:"hidden",name:"model_id",id:i.id+"-model_id"},{layout:"column",items:[{columnWidth:.5,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"pb-combo-field-types",fieldLabel:_("pb_field_type"),name:"type",hiddenName:"type",id:i.id+"-type",combo:i.combo,anchor:"99%",width:99,allowBlank:!1,listeners:{render:{fn:this.changeFields,scope:this},select:{fn:this.changeFields,scope:this}}}]},{columnWidth:.5,layout:"form",defaults:{msgTarget:"under"},cls:"x-superboxselect",items:[{xtype:"pb-combo-getlist",fieldLabel:_("pb_tab"),name:"tab_id",id:i.id+"-tab-id",allowBlank:!0,baseParams:{action:"mgr/tab/getlist",model_type:i.model_type,model_id:i.model_id||0,sort:"menuindex",dir:"asc",combo:1},triggerConfig:{tag:"div",cls:"x-superboxselect-btns",cn:[{tag:"div",cls:"x-superboxselect-btn-expand x-form-trigger"},{tag:"div",cls:"x-superboxselect-btn-clear x-form-trigger"}]},onTriggerClick:function(e,t){t&&Ext.get(t).hasClass("x-superboxselect-btn-clear")?Ext.getCmp(i.id+"-tab-id").setValue(0):MODx.combo.ComboBox.superclass.onTriggerClick.call(this)}}]}]},{layout:"column",items:[{columnWidth:.495,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:_("pb_field_caption"),name:"caption",id:i.id+"-caption",anchor:"99%",width:99,allowBlank:!0,enableKeyEvents:!0,listeners:{keyup:{fn:this.translitAlias,scope:this},blur:{fn:this.translitAlias,scope:this}}}]},{columnWidth:.495,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:_("pb_field_name"),name:"name",id:i.id+"-name",anchor:"99%",width:99,allowBlank:!1,listeners:{render:{fn:e=>{Ext.isEmpty(e.value)||(this.config.aliaswasempty=!1)},scope:this},change:{fn:e=>{Ext.isEmpty(e.getValue())&&(this.config.aliaswasempty=!0)},scope:this}}},{xtype:"label",cls:"desc-under",text:_("pb_field_name_desc")}]}]},{layout:"column",items:[{columnWidth:.695,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:_("pb_field_default"),name:"default",id:i.id+"-default",anchor:"99%",width:99,allowBlank:!0}]},{columnWidth:.295,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"numberfield",inputType:"number",cls:"x-form-text",fieldLabel:_("pb_field_width"),description:_("pb_field_width_desc"),name:"width",id:i.id+"-width",minValue:0,maxValue:100,anchor:"99%",width:99,allowBlank:!1,listeners:{render:function(e){Ext.isEmpty(e.value)&&e.setValue(100)}}}]}]}];return(e=(e=(e=(e=(e=(e=(e=(e=e.concat(this.getSelectField(i))).concat(this.getTableFields(i))).concat(this.getDateFields(i))).concat(this.getNumberFields(i))).concat(this.getImageFields(i))).concat(this.getResourceFields(i))).concat(this.getXtypeFields(i))).concat(this.getRadioFields(i))).push({xtype:"textarea",fieldLabel:_("pb_field_help"),name:"help",height:50,id:i.id+"-help",anchor:"99%",width:99,allowBlank:!0},{xtype:"checkboxgroup",hideLabel:!0,name:"checkboxgroup",columns:3,items:[{xtype:"xcheckbox",boxLabel:_("pb_row_active"),name:"published",id:i.id+"-published",checked:!i.record||i.record.published},{xtype:"xcheckbox",boxLabel:_("pb_field_required"),name:"required",id:i.id+"-required",checked:!!i.record&&i.record.required,hidden:!0}]}),e},getSelectField:function(e){return[{xtype:"textarea",fieldLabel:_("pb_field_values"),name:"values",height:100,id:e.id+"-values",anchor:"99%",width:99,hidden:!0,allowBlank:!0},{xtype:"label",id:e.id+"-values-desc",cls:"desc-under",text:_("pb_field_values_desc"),hidden:!0}]},getConnectorsFields:function(e){return[{xtype:"fieldset",title:"baseParams",id:e.id+"-baseParams",columnWidth:1,collapsible:!0,hidden:!0,anchor:"99%",width:99,items:[{xtype:"textfield",fieldLabel:_("pb_field_connector"),id:e.id+"-connector",name:"connector",anchor:"99%",width:99,listeners:{render:function(e){Ext.isEmpty(e.value)&&e.setValue("/assets/components/pageblocks/connector.php")}}},{xtype:"label",id:e.id+"-connector-desc",cls:"desc-under",text:"MODx connector: /connectors/index.php"},{layout:"column",items:[{columnWidth:.39,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:_("pb_field_processor"),id:e.id+"-processor",name:"processor",anchor:"99%",width:99,listeners:{render:function(e){Ext.isEmpty(e.value)&&e.setValue("web/table/getlist")}}}]},{columnWidth:.2,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"numberfield",inputType:"number",cls:"x-form-text",fieldLabel:_("pb_field_limit"),id:e.id+"-limit",name:"limit",anchor:"99%",width:99,listeners:{render:function(e){Ext.isEmpty(e.value)&&e.setValue(10)}}}]},{columnWidth:.2,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:"displayField",id:e.id+"-displayfield",name:"displayfield",anchor:"99%",width:99}]},{columnWidth:.2,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:"valueField",id:e.id+"-valuefield",name:"valuefield",anchor:"99%",width:99}]}]}]}]},getTableFields:function(e){return[{xtype:"pb-combo-getlist",fieldLabel:_("pb_field_table"),name:"table_id",id:e.id+"-table_id",hidden:!0,allowBlank:!0,anchor:"99%",width:99,baseParams:{action:"mgr/table/getlist",sort:"menuindex",dir:"asc",combo:!0}}]},getDateFields:function(e){return[{layout:"column",items:[{columnWidth:.35,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:_("disabled_dates"),name:"disabled_dates",id:e.id+"-disabled-dates",allowBlank:!0,anchor:"99%",width:99,hidden:!0}]},{columnWidth:.35,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:_("disabled_days"),name:"disabled_days",id:e.id+"-disabled-days",allowBlank:!0,anchor:"99%",width:99,hidden:!0}]},{columnWidth:.29,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"combo-boolean",store:new Ext.data.SimpleStore({fields:["d","v"],data:[[_("yes"),1],[_("no"),0]]}),fieldLabel:_("hide_time"),name:"hide_time",hiddenName:"hide_time",id:e.id+"-hide-time",allowBlank:!0,anchor:"99%",width:99,hidden:!0}]}]},{layout:"column",items:[{columnWidth:.395,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"timefield",increment:5,fieldLabel:_("pb_field_time_minvalue"),name:"time_minvalue",id:e.id+"-time-minvalue",allowBlank:!0,anchor:"99%",width:99,hidden:!0}]},{columnWidth:.395,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"timefield",increment:5,fieldLabel:_("pb_field_time_maxvalue"),name:"time_maxvalue",id:e.id+"-time-maxvalue",allowBlank:!0,anchor:"99%",width:99,hidden:!0,listeners:{render:function(e){Ext.isEmpty(e.value)&&e.setValue(15)}}}]},{columnWidth:.2,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"numberfield",inputType:"number",cls:"x-form-text",fieldLabel:_("pb_field_time_increment"),name:"time_increment",id:e.id+"-time-increment",allowBlank:!0,anchor:"99%",width:99,hidden:!0}]}]}]},getNumberFields:function(e){return[{layout:"column",items:[{columnWidth:.29,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"combo-boolean",store:new Ext.data.SimpleStore({fields:["d","v"],data:[[_("yes"),1],[_("no"),0]]}),fieldLabel:_("number_allownegative"),name:"number_allownegative",hiddenName:"number_allownegative",id:e.id+"-number_allownegative",anchor:"99%",width:99,allowBlank:!0}]},{columnWidth:.35,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"numberfield",inputType:"number",cls:"x-form-text",fieldLabel:_("number_minvalue"),name:"number_minvalue",id:e.id+"-number_minvalue",anchor:"99%",width:99,allowBlank:!0}]},{columnWidth:.35,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"numberfield",inputType:"number",cls:"x-form-text",fieldLabel:_("number_maxvalue"),name:"number_maxvalue",id:e.id+"-number_maxvalue",anchor:"99%",width:99,allowBlank:!0,listeners:{render:function(e){Ext.isEmpty(e.value)&&e.setValue(2147483647)}}}]}]}]},getImageFields:function(e){return[{layout:"column",items:[{columnWidth:.695,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:_("pb_field_source_path"),id:e.id+"-source-path",name:"source_path",anchor:"99%",width:99,allowBlank:!1,listeners:{render:function(e){Ext.isEmpty(e.value)&&e.setValue("/")}}},{xtype:"label",id:e.id+"-source-path-desc",cls:"desc-under",text:_("pb_field_source_path_desc")}]},{columnWidth:.295,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"modx-combo-source",fieldLabel:_("source"),id:e.id+"-source",name:"source",hiddenName:"source",anchor:"99%",width:99,listeners:{render:function(e){!Ext.isEmpty(e.value)&&0!==e.value||e.setValue(MODx.config.default_media_source)}}}]}]}]},getResourceFields:function(e){return[{layout:"column",items:[{columnWidth:.495,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:_("pb_field_sort"),id:e.id+"-sort",name:"sort",anchor:"99%",width:99,hidden:!0,listeners:{render:function(e){Ext.isEmpty(e.value)&&e.setValue("id")}}}]},{columnWidth:.495,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"pb-combo-dir",fieldLabel:_("pb_field_dir"),id:e.id+"-dir",name:"dir",anchor:"99%",width:99,hidden:!0,allowBlank:!1,listeners:{render:function(e){Ext.isEmpty(e.value)&&e.setValue("asc")}}}]}]},{xtype:"textarea",fieldLabel:_("resourcelist_where"),name:"where",id:e.id+"-where",anchor:"99%",width:99,hidden:!0,allowBlank:!0},{xtype:"label",id:e.id+"-where-desc",cls:"desc-under",text:_("pb_field_where_desc")}]},getXtypeFields:function(e){return[{xtype:"textfield",fieldLabel:_("pb_field_xtype"),name:"xtype",id:e.id+"-xtype",anchor:"99%",width:99,hidden:!0,allowBlank:!0},{xtype:"label",id:e.id+"-xtype-desc",cls:"desc-under",text:_("pb_field_xtype_desc"),hidden:!0}]},getRadioFields:function(e){return[{xtype:"numberfield",fieldLabel:_("checkbox_columns"),name:"columns",id:e.id+"-columns",anchor:"99%",width:99,minValue:1,maxValue:10,hidden:!0,allowBlank:!1,listeners:{render:function(e){Ext.isEmpty(e.value)&&e.setValue(3)}}},{xtype:"label",id:e.id+"-columns-desc",cls:"desc-under",text:_("checkbox_columns_desc")}]},changeFields:function(e,t){Ext.isEmpty(e.value)&&Ext.getCmp(this.id+"-type").setValue("textfield");var i=Ext.getCmp(this.id+"-values"),d=Ext.getCmp(this.id+"-values-desc"),l=Ext.getCmp(this.id+"-default"),a=Ext.getCmp(this.id+"-where"),s=Ext.getCmp(this.id+"-where-desc"),n=Ext.getCmp(this.id+"-sort"),o=Ext.getCmp(this.id+"-dir"),r=Ext.getCmp(this.id+"-table_id"),m=Ext.getCmp(this.id+"-number_allownegative"),c=Ext.getCmp(this.id+"-number_minvalue"),u=Ext.getCmp(this.id+"-number_maxvalue"),h=Ext.getCmp(this.id+"-xtype"),b=Ext.getCmp(this.id+"-xtype-desc"),p=Ext.getCmp(this.id+"-columns"),f=Ext.getCmp(this.id+"-columns-desc"),x=Ext.getCmp(this.id+"-width"),g=Ext.getCmp(this.id+"-required"),w=Ext.getCmp(this.id+"-source"),y=Ext.getCmp(this.id+"-source-path"),E=Ext.getCmp(this.id+"-source-path-desc"),k=Ext.getCmp(this.id+"-disabled-dates"),v=Ext.getCmp(this.id+"-disabled-days"),D=Ext.getCmp(this.id+"-hide-time"),C=Ext.getCmp(this.id+"-time-increment"),T=Ext.getCmp(this.id+"-time-minvalue"),B=Ext.getCmp(this.id+"-time-maxvalue");switch(i.hide().setDisabled(!0),d.hide(),a.hide().setDisabled(!0),s.hide(),n.hide().setDisabled(!0),o.hide().setDisabled(!0),r.hide().setDisabled(!0),m.hide().setDisabled(!0),c.hide().setDisabled(!0),u.hide().setDisabled(!0),h.hide().setDisabled(!0),b.hide(),p.hide().setDisabled(!0),f.hide(),x.show().setDisabled(!1),w.hide().setDisabled(!0),y.hide().setDisabled(!0),E.hide(),k.hide().setDisabled(!0),v.hide().setDisabled(!0),D.hide().setDisabled(!0),C.hide().setDisabled(!0),T.hide().setDisabled(!0),B.hide().setDisabled(!0),l.show().setDisabled(!1),g.show().setDisabled(!1),e.value){case"listbox":case"listbox-multiple":case"colorpalette":i.show().setDisabled(!1),d.show().setDisabled(!1);break;case"resourcelist":n.show().setDisabled(!1),o.show().setDisabled(!1),a.show().setDisabled(!1),s.show().setDisabled(!1);break;case"numberfield":m.show().setDisabled(!1).setWidth("100%"),c.show().setDisabled(!1),u.show().setDisabled(!1);break;case"xcheckbox":g.hide();break;case"checkboxgroup":i.show().setDisabled(!1),d.show(),p.show().setDisabled(!1),f.show().setText(_("checkbox_columns_desc"));break;case"radiogroup":i.show().setDisabled(!1),d.show(),p.show().setDisabled(!1),f.show(),f.setText(_("radio_columns_desc"));break;case"pb-panel-image":case"pb-panel-video":case"pb-panel-file":w.show().setDisabled(!1).setValue(MODx.config.default_media_source).setWidth("100%"),y.show().setDisabled(!1),E.show();break;case"xdatetime":k.show().setDisabled(!1),v.show().setDisabled(!1),D.show().setDisabled(!1).setWidth("100%"),C.show().setDisabled(!1),T.show().setDisabled(!1).setWidth("100%"),B.show().setDisabled(!1).setWidth("100%");break;case"timefield":C.show().setDisabled(!1),T.show().setDisabled(!1),B.show().setDisabled(!1);break;case"pb-table":r.show().setDisabled(!1).setWidth("100%"),x.hide().setValue(100),l.hide().setDisabled(!0),g.hide();break;case"pb-xtype":h.show().setDisabled(!1),b.show()}setTimeout(()=>{this.setWinHeight()},300)},translitAlias:function(e){var t;this.config.aliaswasempty&&(e=Ext.util.Format.stripTags(e.getValue()),e=Ext.util.Format.htmlEncode(e),t=Ext.getCmp(this.id+"-name"))&&PageBlocks.utils.translitAlias(e,t)}}),Ext.reg("pb-field-window-create",PageBlocks.window.CreateField),PageBlocks.window.UpdateField=function(e){(e=e||{}).id||(e.id="pb-field-window-update"),Ext.applyIf(e,{title:_("pb_row_update")+": "+e.record.name,action:"mgr/field/update"}),PageBlocks.window.UpdateField.superclass.constructor.call(this,e)},Ext.extend(PageBlocks.window.UpdateField,PageBlocks.window.CreateField),Ext.reg("pb-field-window-update",PageBlocks.window.UpdateField);