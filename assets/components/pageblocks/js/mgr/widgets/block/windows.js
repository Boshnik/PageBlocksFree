PageBlocks.window.CreateBlock=function(e){(e=e||{}).aliaswasempty=!0,e.id||(e.id="pb-block-window-create"),e.model_type="pbBlock",Ext.applyIf(e,{title:_("pb_row_create"),action:"mgr/block/create"}),PageBlocks.window.CreateBlock.superclass.constructor.call(this,e)},Ext.extend(PageBlocks.window.CreateBlock,PageBlocks.window.Default,{getFields:function(a){return[{xtype:"hidden",name:"id",id:a.id+"-id"},{layout:"column",items:[{columnWidth:.5,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:_("pb_block_name"),name:"name",id:a.id+"-name",anchor:"99%",maxLength:255,allowBlank:!1,enableKeyEvents:!0,listeners:{keyup:{fn:this.translitAlias,scope:this},blur:{fn:this.translitAlias,scope:this}}}]},{columnWidth:.5,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:_("pb_block_chunk"),name:"chunk",id:a.id+"-chunk",anchor:"99%",allowBlank:!1,listeners:{render:{fn:e=>{Ext.isEmpty(e.value)||(this.config.aliaswasempty=!1)},scope:this},change:{fn:e=>{Ext.isEmpty(e.getValue())&&(this.config.aliaswasempty=!0)},scope:this}}}]}]},{xtype:"modx-tabs",defaults:{border:!1,autoHeight:!0},id:Ext.id(),items:[{title:_("pb_fields"),layout:"anchor",items:[{xtype:"pb-grid-fields",id:Ext.id(),model_type:a.model_type,model_id:a.record?a.record.id:0,baseParams:{action:"mgr/field/getlist",model_type:a.model_type,model_id:a.record?a.record.id:0,sort:"menuindex",dir:"asc"}}]},{title:_("pb_tabs"),layout:"anchor",items:[{xtype:"pb-grid-tabs",model_type:a.model_type,model_id:a.record?a.record.id:0,clearBtnCls:"x-form-trigger",baseParams:{action:"mgr/tab/getlist",model_type:a.model_type,model_id:a.record?a.record.id:0,sort:"menuindex",dir:"asc"}}]},{title:_("pb_accessibility"),layout:"anchor",items:[{layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"pb-combo-getlist-multiple",fieldLabel:_("pb_templates"),name:"ab_templates",anchor:"100%",url:MODx.config.connector_url,displayField:"templatename",valueField:"id",fields:["templatename","id"],baseParams:{action:"3"===PageBlocks.config.modxversion?"Element/Template/GetList":"element/template/getlist",combo:1,limit:0},listeners:{afterrender:function(t){setTimeout(()=>{var e=a.record?a.record.ab_templates:"";Ext.isEmpty(e)||t.setValue(e.split("||"))},500)}}},{layout:"column",renderTo:Ext.getBody(),items:[{columnWidth:.499,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:_("pb_parents"),name:"ab_parents",id:a.id+"-ab_parents",anchor:"100%",allowBlank:!0}]},{columnWidth:.499,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:_("resources")+" (ID)",name:"ab_resources",id:a.id+"-ab_resources",anchor:"100%",allowBlank:!0}]}]}]}]}]}]},translitAlias:function(e){var t;this.config.aliaswasempty&&(e=Ext.util.Format.stripTags(e.getValue()),e=Ext.util.Format.htmlEncode(e),t=Ext.getCmp(this.id+"-chunk"))&&PageBlocks.utils.translitAlias(e,t)}}),Ext.reg("pb-block-window-create",PageBlocks.window.CreateBlock),PageBlocks.window.UpdateBlock=function(e){(e=e||{}).id||(e.id="pb-block-window-update"),Ext.applyIf(e,{title:_("pb_row_update")+": "+e.record.name,action:"mgr/block/update"}),PageBlocks.window.UpdateBlock.superclass.constructor.call(this,e)},Ext.extend(PageBlocks.window.UpdateBlock,PageBlocks.window.CreateBlock),Ext.reg("pb-block-window-update",PageBlocks.window.UpdateBlock);