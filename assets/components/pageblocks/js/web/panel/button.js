PageBlocks.panel.SuperButton=function(e){(e=e||{}).btn_id=Ext.id(),e.xtype_id=e.id,Ext.apply(e,{baseCls:"pb-panel-button",id:Ext.id(),layout:"anchor",hideMode:"offsets",items:this.getFields(e)}),PageBlocks.panel.SuperButton.superclass.constructor.call(this,e)},Ext.extend(PageBlocks.panel.SuperButton,MODx.Panel,{getFields:function(a){return[{xtype:"button",description:"<b>[[*"+a.name+"]]</b>",fieldLabel:"",id:a.xtype_id+"-panel",text:Ext.isEmpty(a.record)?a.fieldLabel:a.record.caption,cls:"x-btn x-btn-small pb-block-btn-label"+(0==a.record.published?" x-item-disabled":""),handler:function(e){var t=Ext.getCmp(a.xtype_id).getValue(),i=MODx.load({xtype:"pb-button-info",xtype_id:a.xtype_id,btn_id:a.btn_id,record:Ext.isEmpty(t)?"":JSON.parse(t)});i.reset(),Ext.isEmpty(t)||i.setValues(JSON.parse(t)),i.show(e.target)}},{xtype:"hidden",id:a.xtype_id,name:a.name,listeners:{render:function(e){Ext.isEmpty(a.record)||e.setValue(JSON.stringify(a.record))}}}]}}),Ext.reg("pb-panel-button",PageBlocks.panel.SuperButton),PageBlocks.window.Button=function(e){(e=e||{}).id||(e.id=Ext.id()),Ext.applyIf(e,{title:"Button",width:500}),PageBlocks.window.Button.superclass.constructor.call(this,e)},Ext.extend(PageBlocks.window.Button,PageBlocks.window.Default,{getFields:function(e){return[{layout:"column",items:[{columnWidth:.75,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:_("pb_btn_caption"),description:"<b>[[+caption]]</b>",name:"caption",id:e.id+"-caption",anchor:"100%",allowBlank:!0}]},{columnWidth:.25,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"pb-combo-listbox",fieldLabel:_("pb_btn_type"),description:"<b>[[+type]]</b>",name:"type",id:e.id+"-type",anchor:"100%",allowBlank:!0,data:"button||reset||submit||download",listeners:{render:{fn:this.changeBtnType,scope:this},select:{fn:this.changeBtnType,scope:this}}}]}]},{xtype:"modx-combo-browser",fieldLabel:_("pb_btn_file"),description:"<b>[[+file]]</b>",name:"file",id:e.id+"-file",anchor:"100%",allowBlank:!0},{layout:"column",items:[{columnWidth:.5,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"textfield",fieldLabel:_("pb_btn_href"),description:"<b>[[+href]]</b>",name:"href",id:e.id+"-href",anchor:"100%",allowBlank:!0},{xtype:"textfield",fieldLabel:_("pb_btn_name"),description:"<b>[[+href]]</b>",name:"name",id:e.id+"-name",anchor:"100%",allowBlank:!0},{xtype:"textfield",fieldLabel:_("pb_btn_attr"),description:"<b>[[+attr]]</b>",name:"attr",id:e.id+"-attr",anchor:"100%",allowBlank:!0}]},{columnWidth:.5,layout:"form",defaults:{msgTarget:"under"},items:[{xtype:"pb-combo-resource",fieldLabel:_("pb_btn_resource"),description:"<b>[[+resource]]</b>",name:"resource",id:e.id+"-resource",anchor:"100%",allowBlank:!0,baseParams:{action:"web/combo/resourcelist",sort:"id",dir:"asc",limit:10,combo:1,where:'[{"published:=":"1"}]'}},{xtype:"textfield",fieldLabel:_("pb_btn_value"),description:"<b>[[+value]]</b>",name:"value",id:e.id+"-value",anchor:"100%",allowBlank:!0},{xtype:"textfield",fieldLabel:_("pb_btn_classes"),description:"<b>[[+classes]]</b>",name:"classes",id:e.id+"-classes",anchor:"100%",allowBlank:!0}]}]},{xtype:"checkboxgroup",hideLabel:!0,name:"checkboxgroup",columns:3,items:[{xtype:"xcheckbox",boxLabel:_("pb_row_active"),description:"<b>[[+published]]</b>",name:"published",id:e.id+"-published",checked:!e.record||!!+e.record.published},{xtype:"xcheckbox",boxLabel:_("pb_btn_disabled"),description:"<b>[[+disabled]]</b>",name:"disabled",id:e.id+"-disabled",checked:!!e.record&&!!+e.record.disabled},{xtype:"xcheckbox",boxLabel:_("pb_btn_new_window"),description:"<b>[[+target_blank]]</b>",name:"target_blank",id:e.id+"-target_blank",checked:!!e.record&&!!+e.record.target_blank}]}]},submit:function(e){var t=this.fp.getForm(),i=t.getValues();t.isValid()&&(Ext.getCmp(this.xtype_id+"-panel").setText(i.caption),Ext.getCmp(this.xtype_id).setValue(JSON.stringify(i)),this.close(),this.doLayout())},changeBtnType:function(e,t){var i=Ext.getCmp(this.id+"-href"),a=Ext.getCmp(this.id+"-resource"),n=Ext.getCmp(this.id+"-file");i.show(),a.show(),n.hide(),"download"==e.value&&(i.hide(),a.hide(),n.show())}}),Ext.reg("pb-button-info",PageBlocks.window.Button);